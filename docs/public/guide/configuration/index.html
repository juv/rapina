<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="Opinionated, type-safe, contracts over chaos." name=description><title>Configuration - Rapina</title><link href=https://arferreira.github.io/rapina/style.css rel=stylesheet><link href=https://arferreira.github.io/rapina/images/rapina-icon.png rel=icon type=image/png><body><nav class=navbar><div class=nav-container><a class=nav-logo href=https://arferreira.github.io/rapina> <img alt=Rapina height=32 src=https://arferreira.github.io/rapina/images/rapina-icon.png> <span>Rapina</span> </a><div class=nav-links><a href=https://arferreira.github.io/rapina/guide> Guide </a><a href=https://arferreira.github.io/rapina/cli> CLI </a><a href=https://arferreira.github.io/rapina/philosophy> Philosophy </a><a href=https://docs.rs/rapina rel=noopener target=_blank> API </a><a class=nav-github href=https://github.com/arferreira/rapina rel=noopener target=_blank> GitHub </a></div></div></nav><main><div class=docs-layout><aside class=docs-sidebar><nav class=docs-nav><h4><a href=https://arferreira.github.io/rapina/guide/>Guide</a></h4><ul><li><a href=https://arferreira.github.io/rapina/guide/getting-started/> Getting Started </a><li><a class=active href=https://arferreira.github.io/rapina/guide/configuration/> Configuration </a><li><a href=https://arferreira.github.io/rapina/guide/extractors/> Extractors </a><li><a href=https://arferreira.github.io/rapina/guide/authentication/> Authentication </a><li><a href=https://arferreira.github.io/rapina/guide/errors/> Error Handling </a></ul></nav></aside><article class=docs-content><h1>Configuration</h1><p class=page-description>Type-safe configuration from environment variables<h2 id=environment-variables>Environment Variables</h2><p>Rapina uses environment variables for configuration. Create a <code>.env</code> file for local development:<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>DATABASE_URL</span><span>=</span><span style=color:#a3be8c>postgres://localhost/myapp
</span><span style=color:#bf616a>PORT</span><span>=</span><span style=color:#a3be8c>3000
</span><span style=color:#bf616a>JWT_SECRET</span><span>=</span><span style=color:#a3be8c>your-secret-key
</span></code></pre><p>Load the <code>.env</code> file at startup:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span style=color:#b48ead>use </span><span>rapina::prelude::*;
</span><span>
</span><span>#[</span><span style=color:#bf616a>tokio</span><span>::</span><span style=color:#bf616a>main</span><span>]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>main</span><span>() -> std::io::Result<()> {
</span><span>    </span><span style=color:#96b5b4>load_dotenv</span><span>();  </span><span style=color:#65737e>// Load .env file
</span><span>
</span><span>    </span><span style=color:#65737e>// ...
</span><span>}
</span></code></pre><h2 id=config-derive-macro>Config Derive Macro</h2><p>Use the <code>#[derive(Config)]</code> macro for type-safe configuration:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span style=color:#b48ead>use </span><span>rapina::prelude::*;
</span><span>
</span><span>#[</span><span style=color:#bf616a>derive</span><span>(Config, Clone)]
</span><span style=color:#b48ead>struct </span><span>AppConfig {
</span><span>    #[</span><span style=color:#bf616a>env </span><span>= "</span><span style=color:#a3be8c>DATABASE_URL</span><span>"]
</span><span>    </span><span style=color:#bf616a>database_url</span><span>: String,
</span><span>
</span><span>    #[</span><span style=color:#bf616a>env </span><span>= "</span><span style=color:#a3be8c>PORT</span><span>"]
</span><span>    #[</span><span style=color:#bf616a>default </span><span>= "</span><span style=color:#a3be8c>3000</span><span>"]
</span><span>    </span><span style=color:#bf616a>port</span><span>: </span><span style=color:#b48ead>u16</span><span>,
</span><span>
</span><span>    #[</span><span style=color:#bf616a>env </span><span>= "</span><span style=color:#a3be8c>HOST</span><span>"]
</span><span>    #[</span><span style=color:#bf616a>default </span><span>= "</span><span style=color:#a3be8c>127.0.0.1</span><span>"]
</span><span>    </span><span style=color:#bf616a>host</span><span>: String,
</span><span>}
</span><span>
</span><span>#[</span><span style=color:#bf616a>tokio</span><span>::</span><span style=color:#bf616a>main</span><span>]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>main</span><span>() -> std::io::Result<()> {
</span><span>    </span><span style=color:#96b5b4>load_dotenv</span><span>();
</span><span>
</span><span>    </span><span style=color:#b48ead>let</span><span> config = AppConfig::from_env().</span><span style=color:#96b5b4>expect</span><span>("</span><span style=color:#a3be8c>Missing config</span><span>");
</span><span>
</span><span>    Rapina::new()
</span><span>        .</span><span style=color:#96b5b4>state</span><span>(config.</span><span style=color:#96b5b4>clone</span><span>())
</span><span>        .</span><span style=color:#96b5b4>router</span><span>(router)
</span><span>        .</span><span style=color:#96b5b4>listen</span><span>(format!("</span><span style=color:#d08770>{}</span><span style=color:#a3be8c>:</span><span style=color:#d08770>{}</span><span>", config.host, config.port))
</span><span>        .await
</span><span>}
</span></code></pre><h2 id=attributes>Attributes</h2><table><thead><tr><th>Attribute<th>Description<tbody><tr><td><code>#[env = "VAR_NAME"]</code><td>Environment variable name<tr><td><code>#[default = "value"]</code><td>Default value if not set</table><h2 id=fail-fast-validation>Fail-Fast Validation</h2><p>If required variables are missing, <code>from_env()</code> returns an error listing <strong>all</strong> missing variables at once:<pre style=color:#c0c5ce;background-color:#2b303b><code><span>Error: Missing environment variables: DATABASE_URL, JWT_SECRET
</span></code></pre><p>This prevents the frustrating cycle of fixing one error at a time.<h2 id=accessing-config-in-handlers>Accessing Config in Handlers</h2><p>Use the <code>State</code> extractor to access configuration in handlers:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span>#[</span><span style=color:#bf616a>get</span><span>("</span><span style=color:#a3be8c>/config</span><span>")]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>show_config</span><span>(</span><span style=color:#bf616a>config</span><span>: State&LTAppConfig>) -> String {
</span><span>    format!("</span><span style=color:#a3be8c>Running on port </span><span style=color:#d08770>{}</span><span>", config.</span><span style=color:#96b5b4>into_inner</span><span>().port)
</span><span>}
</span></code></pre><div class=page-meta></div></article></div></main><footer class=footer><div class=footer-container><p>Built with Rust. Documented with <a href=https://www.getzola.org/ target=_blank>Zola</a>.<p>MIT License</div></footer>