<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="Opinionated, type-safe, contracts over chaos." name=description><title>Extractors - Rapina</title><link href=https://arferreira.github.io/rapina/style.css rel=stylesheet><link href=https://arferreira.github.io/rapina/images/rapina-icon.png rel=icon type=image/png><body><nav class=navbar><div class=nav-container><a class=nav-logo href=https://arferreira.github.io/rapina> <img alt=Rapina height=32 src=https://arferreira.github.io/rapina/images/rapina-icon.png> <span>Rapina</span> </a><div class=nav-links><a href=https://arferreira.github.io/rapina/guide> Guide </a><a href=https://arferreira.github.io/rapina/cli> CLI </a><a href=https://arferreira.github.io/rapina/philosophy> Philosophy </a><a href=https://docs.rs/rapina rel=noopener target=_blank> API </a><a class=nav-github href=https://github.com/arferreira/rapina rel=noopener target=_blank> GitHub </a></div></div></nav><main><div class=docs-layout><aside class=docs-sidebar><nav class=docs-nav><h4><a href=https://arferreira.github.io/rapina/guide/>Guide</a></h4><ul><li><a href=https://arferreira.github.io/rapina/guide/getting-started/> Getting Started </a><li><a href=https://arferreira.github.io/rapina/guide/configuration/> Configuration </a><li><a class=active href=https://arferreira.github.io/rapina/guide/extractors/> Extractors </a><li><a href=https://arferreira.github.io/rapina/guide/authentication/> Authentication </a><li><a href=https://arferreira.github.io/rapina/guide/errors/> Error Handling </a></ul></nav></aside><article class=docs-content><h1>Extractors</h1><p class=page-description>Parse request data with type safety<p>Extractors automatically parse request data and inject it into your handlers. If parsing fails, they return appropriate error responses.<h2 id=available-extractors>Available Extractors</h2><table><thead><tr><th>Extractor<th>Description<tbody><tr><td><code>Path&LTT></code><td>URL path parameters<tr><td><code>Query&LTT></code><td>Query string parameters<tr><td><code>Json&LTT></code><td>JSON request body<tr><td><code>Form&LTT></code><td>URL-encoded form data<tr><td><code>Headers</code><td>Request headers<tr><td><code>State&LTT></code><td>Application state<tr><td><code>Context</code><td>Request context (trace_id)<tr><td><code>CurrentUser</code><td>Authenticated user (JWT)<tr><td><code>Validated&LTT></code><td>Validated extractor</table><h2 id=path-parameters>Path Parameters</h2><p>Extract values from URL path segments:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span>#[</span><span style=color:#bf616a>get</span><span>("</span><span style=color:#a3be8c>/users/:id</span><span>")]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>get_user</span><span>(</span><span style=color:#bf616a>id</span><span>: Path<</span><span style=color:#b48ead>u64</span><span>>) -> String {
</span><span>    format!("</span><span style=color:#a3be8c>User ID: </span><span style=color:#d08770>{}</span><span>", id.</span><span style=color:#96b5b4>into_inner</span><span>())
</span><span>}
</span><span>
</span><span>#[</span><span style=color:#bf616a>get</span><span>("</span><span style=color:#a3be8c>/posts/:year/:month</span><span>")]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>archive</span><span>(</span><span style=color:#bf616a>year</span><span>: Path<</span><span style=color:#b48ead>u32</span><span>>, </span><span style=color:#bf616a>month</span><span>: Path<</span><span style=color:#b48ead>u32</span><span>>) -> String {
</span><span>    format!("</span><span style=color:#d08770>{}</span><span style=color:#a3be8c>/</span><span style=color:#d08770>{}</span><span>", year.</span><span style=color:#96b5b4>into_inner</span><span>(), month.</span><span style=color:#96b5b4>into_inner</span><span>())
</span><span>}
</span></code></pre><h2 id=query-parameters>Query Parameters</h2><p>Parse query strings into typed structs:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span>#[</span><span style=color:#bf616a>derive</span><span>(Deserialize)]
</span><span style=color:#b48ead>struct </span><span>Pagination {
</span><span>    </span><span style=color:#bf616a>page</span><span>: Option<</span><span style=color:#b48ead>u32</span><span>>,
</span><span>    </span><span style=color:#bf616a>limit</span><span>: Option<</span><span style=color:#b48ead>u32</span><span>>,
</span><span>}
</span><span>
</span><span>#[</span><span style=color:#bf616a>get</span><span>("</span><span style=color:#a3be8c>/users</span><span>")]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>list_users</span><span>(</span><span style=color:#bf616a>query</span><span>: Query&LTPagination>) -> String {
</span><span>    </span><span style=color:#b48ead>let</span><span> page = query.</span><span style=color:#d08770>0.</span><span>page.</span><span style=color:#96b5b4>unwrap_or</span><span>(</span><span style=color:#d08770>1</span><span>);
</span><span>    </span><span style=color:#b48ead>let</span><span> limit = query.</span><span style=color:#d08770>0.</span><span>limit.</span><span style=color:#96b5b4>unwrap_or</span><span>(</span><span style=color:#d08770>20</span><span>);
</span><span>    format!("</span><span style=color:#a3be8c>Page </span><span style=color:#d08770>{}</span><span style=color:#a3be8c> with </span><span style=color:#d08770>{}</span><span style=color:#a3be8c> items</span><span>", page, limit)
</span><span>}
</span></code></pre><h2 id=json-body>JSON Body</h2><p>Parse JSON request bodies:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span>#[</span><span style=color:#bf616a>derive</span><span>(Deserialize)]
</span><span style=color:#b48ead>struct </span><span>CreateUser {
</span><span>    </span><span style=color:#bf616a>name</span><span>: String,
</span><span>    </span><span style=color:#bf616a>email</span><span>: String,
</span><span>}
</span><span>
</span><span>#[</span><span style=color:#bf616a>post</span><span>("</span><span style=color:#a3be8c>/users</span><span>")]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>create_user</span><span>(</span><span style=color:#bf616a>body</span><span>: Json&LTCreateUser>) -> Json&LTUser> {
</span><span>    </span><span style=color:#b48ead>let</span><span> input = body.</span><span style=color:#96b5b4>into_inner</span><span>();
</span><span>    </span><span style=color:#65737e>// Create user...
</span><span>    Json(user)
</span><span>}
</span></code></pre><h2 id=form-data>Form Data</h2><p>Parse URL-encoded form submissions:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span>#[</span><span style=color:#bf616a>derive</span><span>(Deserialize)]
</span><span style=color:#b48ead>struct </span><span>LoginForm {
</span><span>    </span><span style=color:#bf616a>username</span><span>: String,
</span><span>    </span><span style=color:#bf616a>password</span><span>: String,
</span><span>}
</span><span>
</span><span>#[</span><span style=color:#bf616a>post</span><span>("</span><span style=color:#a3be8c>/login</span><span>")]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>login</span><span>(</span><span style=color:#bf616a>form</span><span>: Form&LTLoginForm>) -> Result&LTJson&LTTokenResponse>> {
</span><span>    </span><span style=color:#b48ead>let</span><span> credentials = form.</span><span style=color:#96b5b4>into_inner</span><span>();
</span><span>    </span><span style=color:#65737e>// Authenticate...
</span><span>}
</span></code></pre><h2 id=headers>Headers</h2><p>Access request headers:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span>#[</span><span style=color:#bf616a>get</span><span>("</span><span style=color:#a3be8c>/debug</span><span>")]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>debug</span><span>(</span><span style=color:#bf616a>headers</span><span>: Headers) -> String {
</span><span>    </span><span style=color:#b48ead>let</span><span> user_agent = headers
</span><span>        .</span><span style=color:#96b5b4>get</span><span>("</span><span style=color:#a3be8c>user-agent</span><span>")
</span><span>        .</span><span style=color:#96b5b4>and_then</span><span>(|</span><span style=color:#bf616a>v</span><span>| v.</span><span style=color:#96b5b4>to_str</span><span>().</span><span style=color:#96b5b4>ok</span><span>())
</span><span>        .</span><span style=color:#96b5b4>unwrap_or</span><span>("</span><span style=color:#a3be8c>unknown</span><span>");
</span><span>
</span><span>    format!("</span><span style=color:#a3be8c>User-Agent: </span><span style=color:#d08770>{}</span><span>", user_agent)
</span><span>}
</span></code></pre><h2 id=application-state>Application State</h2><p>Access shared application state:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span>#[</span><span style=color:#bf616a>derive</span><span>(Clone)]
</span><span style=color:#b48ead>struct </span><span>AppConfig {
</span><span>    </span><span style=color:#bf616a>app_name</span><span>: String,
</span><span>}
</span><span>
</span><span>#[</span><span style=color:#bf616a>get</span><span>("</span><span style=color:#a3be8c>/info</span><span>")]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>info</span><span>(</span><span style=color:#bf616a>config</span><span>: State&LTAppConfig>) -> String {
</span><span>    format!("</span><span style=color:#a3be8c>App: </span><span style=color:#d08770>{}</span><span>", config.</span><span style=color:#96b5b4>into_inner</span><span>().app_name)
</span><span>}
</span></code></pre><h2 id=request-context>Request Context</h2><p>Access the request context with trace ID:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span>#[</span><span style=color:#bf616a>get</span><span>("</span><span style=color:#a3be8c>/trace</span><span>")]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>trace</span><span>(</span><span style=color:#bf616a>ctx</span><span>: Context) -> String {
</span><span>    format!("</span><span style=color:#a3be8c>Trace ID: </span><span style=color:#d08770>{}</span><span>", ctx.</span><span style=color:#96b5b4>trace_id</span><span>())
</span><span>}
</span></code></pre><h2 id=validation>Validation</h2><p>Validate extracted data using the <code>validator</code> crate:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span style=color:#b48ead>use </span><span>validator::Validate;
</span><span>
</span><span>#[</span><span style=color:#bf616a>derive</span><span>(Deserialize, Validate)]
</span><span style=color:#b48ead>struct </span><span>CreateUser {
</span><span>    #[</span><span style=color:#bf616a>validate</span><span>(email)]
</span><span>    </span><span style=color:#bf616a>email</span><span>: String,
</span><span>
</span><span>    #[</span><span style=color:#bf616a>validate</span><span>(</span><span style=color:#bf616a>length</span><span>(min = 8))]
</span><span>    </span><span style=color:#bf616a>password</span><span>: String,
</span><span>}
</span><span>
</span><span>#[</span><span style=color:#bf616a>post</span><span>("</span><span style=color:#a3be8c>/users</span><span>")]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>create_user</span><span>(</span><span style=color:#bf616a>body</span><span>: Validated&LTJson&LTCreateUser>>) -> Json&LTUser> {
</span><span>    </span><span style=color:#65737e>// body is guaranteed to be valid
</span><span>    </span><span style=color:#b48ead>let</span><span> input = body.</span><span style=color:#96b5b4>into_inner</span><span>().</span><span style=color:#96b5b4>into_inner</span><span>();
</span><span>    </span><span style=color:#65737e>// ...
</span><span>}
</span></code></pre><p>If validation fails, returns 422 with validation error details.<h2 id=multiple-extractors>Multiple Extractors</h2><p>You can use multiple extractors in a single handler:<pre class=language-rust data-lang=rust style=color:#c0c5ce;background-color:#2b303b><code class=language-rust data-lang=rust><span>#[</span><span style=color:#bf616a>post</span><span>("</span><span style=color:#a3be8c>/users/:id/posts</span><span>")]
</span><span>async </span><span style=color:#b48ead>fn </span><span style=color:#8fa1b3>create_post</span><span>(
</span><span>    </span><span style=color:#bf616a>id</span><span>: Path<</span><span style=color:#b48ead>u64</span><span>>,
</span><span>    </span><span style=color:#bf616a>user</span><span>: CurrentUser,
</span><span>    </span><span style=color:#bf616a>body</span><span>: Json&LTCreatePost>,
</span><span>) -> Result&LTJson&LTPost>> {
</span><span>    </span><span style=color:#65737e>// All extractors available
</span><span>}
</span></code></pre><blockquote><p><strong>Note:</strong> Only one body-consuming extractor (<code>Json</code>, <code>Form</code>) can be used per handler.</blockquote><div class=page-meta></div></article></div></main><footer class=footer><div class=footer-container><p>Built with Rust. Documented with <a href=https://www.getzola.org/ target=_blank>Zola</a>.<p>MIT License</div></footer>